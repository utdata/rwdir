<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Reporting with Data in R - 4&nbsp; Summarize: count - analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./sums-import.html" rel="next">
<link href="./counts-import.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./counts-analysis.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Summarize: count - analysis</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Reporting with Data in R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About this book</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./install.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Install Party</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./counts-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Summarize: count - import</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./counts-analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Summarize: count - analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sums-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Summarize: math - import</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sums-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Summarize: math - analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Viz - Intro to ggplot</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidy-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Tidy data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bind-join.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Bind and join</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./answers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Plotting for answers</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./group-dates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Grouping by dates</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">R Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./troubleshooting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Troubleshooting</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./explore.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Exploring a new dataset</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./charts-tips.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Chart production tips</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#goals-of-this-lesson" id="toc-goals-of-this-lesson" class="nav-link active" data-scroll-target="#goals-of-this-lesson"><span class="header-section-number">4.1</span> Goals of this lesson</a></li>
  <li><a href="#the-questions-well-answer" id="toc-the-questions-well-answer" class="nav-link" data-scroll-target="#the-questions-well-answer"><span class="header-section-number">4.2</span> The questions we’ll answer</a></li>
  <li><a href="#setting-up-an-analysis-notebook" id="toc-setting-up-an-analysis-notebook" class="nav-link" data-scroll-target="#setting-up-an-analysis-notebook"><span class="header-section-number">4.3</span> Setting up an analysis notebook</a>
  <ul class="collapse">
  <li><a href="#import-the-cleaned-data" id="toc-import-the-cleaned-data" class="nav-link" data-scroll-target="#import-the-cleaned-data"><span class="header-section-number">4.3.1</span> Import the cleaned data</a></li>
  </ul></li>
  <li><a href="#introducing-dplyr" id="toc-introducing-dplyr" class="nav-link" data-scroll-target="#introducing-dplyr"><span class="header-section-number">4.4</span> Introducing dplyr</a></li>
  <li><a href="#most-appearances" id="toc-most-appearances" class="nav-link" data-scroll-target="#most-appearances"><span class="header-section-number">4.5</span> Most appearances</a>
  <ul class="collapse">
  <li><a href="#group-aggregate" id="toc-group-aggregate" class="nav-link" data-scroll-target="#group-aggregate"><span class="header-section-number">4.5.1</span> Group &amp; Aggregate</a></li>
  <li><a href="#summarize" id="toc-summarize" class="nav-link" data-scroll-target="#summarize"><span class="header-section-number">4.5.2</span> Summarize</a></li>
  <li><a href="#group-by" id="toc-group-by" class="nav-link" data-scroll-target="#group-by"><span class="header-section-number">4.5.3</span> Group by</a></li>
  <li><a href="#arrange-the-results" id="toc-arrange-the-results" class="nav-link" data-scroll-target="#arrange-the-results"><span class="header-section-number">4.5.4</span> Arrange the results</a></li>
  <li><a href="#get-the-top-of-the-list" id="toc-get-the-top-of-the-list" class="nav-link" data-scroll-target="#get-the-top-of-the-list"><span class="header-section-number">4.5.5</span> Get the top of the list</a></li>
  </ul></li>
  <li><a href="#titleperformer-combo-with-most-appearances" id="toc-titleperformer-combo-with-most-appearances" class="nav-link" data-scroll-target="#titleperformer-combo-with-most-appearances"><span class="header-section-number">4.6</span> Title/performer combo with most appearances</a>
  <ul class="collapse">
  <li><a href="#introducing-filter" id="toc-introducing-filter" class="nav-link" data-scroll-target="#introducing-filter"><span class="header-section-number">4.6.1</span> Introducing filter()</a></li>
  </ul></li>
  <li><a href="#titleperformer-with-most-weeks-at-no.-1" id="toc-titleperformer-with-most-weeks-at-no.-1" class="nav-link" data-scroll-target="#titleperformer-with-most-weeks-at-no.-1"><span class="header-section-number">4.7</span> Title/Performer with most weeks at No.&nbsp;1</a></li>
  <li><a href="#performer-with-most-titles-to-reach-no.-1" id="toc-performer-with-most-titles-to-reach-no.-1" class="nav-link" data-scroll-target="#performer-with-most-titles-to-reach-no.-1"><span class="header-section-number">4.8</span> Performer with most titles to reach No.&nbsp;1</a>
  <ul class="collapse">
  <li><a href="#using-distinct" id="toc-using-distinct" class="nav-link" data-scroll-target="#using-distinct"><span class="header-section-number">4.8.1</span> Using distinct()</a></li>
  <li><a href="#summarize-the-performers" id="toc-summarize-the-performers" class="nav-link" data-scroll-target="#summarize-the-performers"><span class="header-section-number">4.8.2</span> Summarize the performers</a></li>
  <li><a href="#filter-for-a-good-cutoff" id="toc-filter-for-a-good-cutoff" class="nav-link" data-scroll-target="#filter-for-a-good-cutoff"><span class="header-section-number">4.8.3</span> Filter for a good cutoff</a></li>
  </ul></li>
  <li><a href="#no.-1-hits-in-last-five-years" id="toc-no.-1-hits-in-last-five-years" class="nav-link" data-scroll-target="#no.-1-hits-in-last-five-years"><span class="header-section-number">4.9</span> No.&nbsp;1 hits in last five years</a></li>
  <li><a href="#top-10-hits-overall-on-your-own" id="toc-top-10-hits-overall-on-your-own" class="nav-link" data-scroll-target="#top-10-hits-overall-on-your-own"><span class="header-section-number">4.10</span> Top 10 hits overall (on your own)</a></li>
  <li><a href="#complex-filters" id="toc-complex-filters" class="nav-link" data-scroll-target="#complex-filters"><span class="header-section-number">4.11</span> Complex filters</a>
  <ul class="collapse">
  <li><a href="#multiple-truths" id="toc-multiple-truths" class="nav-link" data-scroll-target="#multiple-truths"><span class="header-section-number">4.11.1</span> Multiple truths</a></li>
  <li><a href="#either-is-true" id="toc-either-is-true" class="nav-link" data-scroll-target="#either-is-true"><span class="header-section-number">4.11.2</span> Either is true</a></li>
  <li><a href="#mixing-criteria" id="toc-mixing-criteria" class="nav-link" data-scroll-target="#mixing-criteria"><span class="header-section-number">4.11.3</span> Mixing criteria</a></li>
  <li><a href="#search-within-a-string" id="toc-search-within-a-string" class="nav-link" data-scroll-target="#search-within-a-string"><span class="header-section-number">4.11.4</span> Search within a string</a></li>
  </ul></li>
  <li><a href="#on-your-own" id="toc-on-your-own" class="nav-link" data-scroll-target="#on-your-own"><span class="header-section-number">4.12</span> On your own</a></li>
  <li><a href="#a-shortcut-count" id="toc-a-shortcut-count" class="nav-link" data-scroll-target="#a-shortcut-count"><span class="header-section-number">4.13</span> A shortcut: count()</a></li>
  <li><a href="#review-of-what-weve-learned" id="toc-review-of-what-weve-learned" class="nav-link" data-scroll-target="#review-of-what-weve-learned"><span class="header-section-number">4.14</span> Review of what we’ve learned</a></li>
  <li><a href="#turn-in-your-project" id="toc-turn-in-your-project" class="nav-link" data-scroll-target="#turn-in-your-project"><span class="header-section-number">4.15</span> Turn in your project</a></li>
  <li><a href="#soundtrack-for-this-assignment" id="toc-soundtrack-for-this-assignment" class="nav-link" data-scroll-target="#soundtrack-for-this-assignment"><span class="header-section-number">4.16</span> Soundtrack for this assignment</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="count-analysis" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Summarize: count - analysis</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This chapter is by Prof.&nbsp;McDonald and keyboard commands and screenshots are from macOS.</p>
<p>This chapter continues the Billboard Hot 100 project. In the previous chapter we downloaded, imported and cleaned the data. We’ll be working in the same project.</p>
<section id="goals-of-this-lesson" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="goals-of-this-lesson"><span class="header-section-number">4.1</span> Goals of this lesson</h2>
<ul>
<li>To use the group_by/summarize/arrange combination to count rows of data.</li>
<li>To use filter in two ways: to focus data before summarizing, and to logically end summarized lists.</li>
<li>We’ll also cover some more complex filters using and/or logic.</li>
<li>Introduce the shortcut <code>count()</code> function</li>
</ul>
<blockquote class="blockquote">
<p>OF NOTE: I updated the data used in this book so some written word references to code results <em>might</em> be different than the actual data in the book or what you get on your computer. I’ve tried to catch them all, but I’m a fallible human.</p>
</blockquote>
</section>
<section id="the-questions-well-answer" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="the-questions-well-answer"><span class="header-section-number">4.2</span> The questions we’ll answer</h2>
<p>Now that we have the Billboard Hot 100 charts data in our project it’s time to find the answers to the following questions:</p>
<ul>
<li>Which performer had the most appearances on the Hot 100 chart at any position?</li>
<li>Which title/performer combination has been on the charts the most number of weeks at any position?</li>
<li>Which title/performer combination was No.&nbsp;1 for the most number of weeks?</li>
<li>Which performer had the most songs reach No.&nbsp;1?</li>
<li>Which performer had the most songs reach No.&nbsp;1 in the most recent five years?</li>
<li>How many appearances for a specific performer in each year?</li>
<li>Which performer had the most Top 10 hits overall?</li>
</ul>
<blockquote class="blockquote">
<p>What are your guesses for the questions above? NO PEEKING!</p>
</blockquote>
<p>In each case we’ll talk over the logic of finding the answer and the code to accomplish it.</p>
<p>Before we can get into the analysis, we want to set up a new notebook to separate our cleaning from our analysis.</p>
</section>
<section id="setting-up-an-analysis-notebook" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="setting-up-an-analysis-notebook"><span class="header-section-number">4.3</span> Setting up an analysis notebook</h2>
<p>At the end of the last notebook we exported our clean data as an <code>.rds</code> file. We’ll now create a new notebook and import that data. It will be much easier this time.</p>
<ol type="1">
<li>If you don’t already have it open, go ahead and open your Billboard project.</li>
<li>If your import notebook is still open, go ahead and close it.</li>
<li>Use the <code>+</code> menu to start a new <strong>R Notebook</strong>.</li>
<li>Update the title as “Billboard analysis” and then remove all the boilerplate text below the YAML metadata.</li>
<li>Save the file as <code>02-analysis.Rmd</code> in your project folder.</li>
<li>Check your Environment tab (top right) and make sure the environment is empty. We don’t want to have any leftover data. If there is, then go under the <strong>Run</strong> menu and choose <strong>Restart R and Clear Output</strong>.</li>
</ol>
<p>Since we are starting a new notebook, we need to set up a few things. First up we want to list our goals.</p>
<ol type="1">
<li>Add a headline and text describing the goals of this notebook. You are exploring the Billboard Hot 100 charts data.</li>
<li>Go ahead and copy all the questions we outlined above into your notebook.</li>
<li>Format those questions as a nice list. Start each line with a <code>-</code> or <code>*</code> followed by a space. There should be a blank line above and below the entire LIST but not between the items. List tiems should be on sequential lines … and it is the only markdown item like that.</li>
<li>Now add a another headline (two hashes) called Setup.</li>
<li>Add a chunk, also name it “setup” and add the tidyverse and lubridate libraries.</li>
<li>Run the chunk to load the library.</li>
</ol>
<section id="import-the-cleaned-data" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="import-the-cleaned-data"><span class="header-section-number">4.3.1</span> Import the cleaned data</h3>
<p>We need to import the data that we cleaned and exported in the last notebook. It’s just a couple of lines of code and you could write them all out and run it, but here is where I tell you for the first of a 1,000 times:</p>
<p><strong>WRITE ONE LINE OF CODE. RUN IT. CHECK THE RESULTS. REPEAT.</strong></p>
<p>Yes, sometimes for the sake of brevity I will give you multiple lines of code at once, but to understand what is actually going on you should add and run that code one line at a time.</p>
<p>We’ll painstakingly walk through that process here to belabor the point. Here are our goals for this bit:</p>
<ul>
<li>Document that we are importing clean data</li>
<li>Import our cleaned data</li>
<li>Fill an R object with that data</li>
<li>Glimpse the R Object so we can check it</li>
</ul>
<p>I want you to:</p>
<ol type="1">
<li>Start a Markdown section with a headline noting you are importing the cleaned data. Add any other text notes you might need for yourself.</li>
<li>Add a code chunk and name it “import”.</li>
<li>In your code chunk, add this line of code:</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_rds</span>(<span class="st">"data-processed/01-hot100.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This <code>read_rds()</code> function is just like the <code>read_csv()</code> function we used in our last notebook to read in data from our computer, except we are reading a different kind of file format: RDS. The argument (in quotes) is the path where our file is on our computer.</p>
<ol type="1">
<li>Run that line of code.</li>
</ol>
<p>What did you expect to happen? It should print the results of the data in your notebook. Did it?</p>
<p>If you got an error, you should read that error output for some clues about what happened. When using a <code>read_</code> function problems are usually about the path … that you have the folder structure wrong or something misspelled.</p>
<blockquote class="blockquote">
<p>CATCHING COMMON MISTAKES: This guide about <a href="https://nickch-k.github.io/DataCommSlides/Lecture_04_Common_R_Problems.html">common R mistakes</a> is worth bookmarking and reading.</p>
</blockquote>
<p>Our next goal is to take all that data and put it into a new R object.</p>
<ol type="1">
<li><strong>Edit</strong> your one line of code to assign the data to an object <code>hot100</code>. Remember we will put the new object FIRST (our bucket) and then use the <code>&lt;-</code> operator to put the data inside it.</li>
<li>Run it!</li>
</ol>
<p>It should look like this:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data-processed/01-hot100.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>What happened when you ran the code? Did you get an error? Did you get a result printed to the screen?</p>
<p>That last one was kind of a trick question. When you save data into an object it does NOT print it to your notebook, but it does save that object into your “Environment”, which means it is in memory and can be called and run at any time. You should see <code>hot100</code> listed in your Environment tab the top right of RStudio.</p>
<p>Now, before I started this quest, I knew I wanted that data inside the <code>hot100</code> object and could’ve written it like that from the beginning. But I didn’t becuase most “read” problems are in the path, so I wanted to make sure that function was written correctly first. Also, when I put the data into the object I can’t see it until I print it out again, so I do it one piece at at time. You should, too.</p>
<p>So next we’ll print the data out to our screen. We do that by just by calling the object.</p>
<ol type="1">
<li><strong>Edit</strong> your code chunk to add a blank line then the object and run it, like this:</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data-processed/01-hot100.rds"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>hot100</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This should print out the data to your screen so you can see the first couple of columns and the first 10 rows of data.</p>
<p>But what we really need is to see all the column names, the data types and an example of the data. We can get that with our <code>glimpse()</code> function.</p>
<ol type="1">
<li><strong>Edit</strong> the last line of the chunk to add the pipe and the <code>glimpse()</code> function</li>
<li>Run it.</li>
</ol>
<p>Your code (and result) should look like this now:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data-processed/01-hot100.rds"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 336,100
Columns: 7
$ chart_date    &lt;date&gt; 1958-08-04, 1958-08-04, 1958-08-04, 1958-08-04, 1958-08…
$ current_rank  &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1…
$ title         &lt;chr&gt; "Poor Little Fool", "Patricia", "Splish Splash", "Hard H…
$ performer     &lt;chr&gt; "Ricky Nelson", "Perez Prado And His Orchestra", "Bobby …
$ previous_rank &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
$ peak_rank     &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1…
$ wks_on_chart  &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…</code></pre>
</div>
</div>
<p>Again, I could’ve written all that code at once before running it, as I’ve written code like that for many years. <strong>I still write code one line at a time</strong>, and you should, too. It is the only way to make sure your code is correct. It’s easier to find problems. So, for the second of a 1,000 times:</p>
<p><strong>WRITE ONE LINE OF CODE. RUN IT. CHECK THE RESULTS. REPEAT.</strong></p>
<blockquote class="blockquote">
<p>IMPORTANT NOTE: If you are looking at my code and writing it into your notebook, you have to run each line of code BEFORE you add the pipe <code>|&gt;</code> at the end of that line. A pipe <code>|&gt;</code> must have a function directly following it on the same or next (or same) line to work.</p>
</blockquote>
</section>
</section>
<section id="introducing-dplyr" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="introducing-dplyr"><span class="header-section-number">4.4</span> Introducing dplyr</h2>
<p>One of the packages within the tidyverse is <a href="https://dplyr.tidyverse.org/">dplyr</a>. Dplyr allows us to transform our data frames in ways that let us explore the data and prepare it for visualizing. It’s the R equivalent of common Excel functions like sort, filter and pivoting.</p>
<blockquote class="blockquote">
<p>There is a cheatsheet on the <a href="https://dplyr.tidyverse.org/">dplyr</a> that you might find useful.</p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/transform-dplyractions.png" class="img-fluid figure-img" width="600"></p>
<figcaption class="figure-caption">Images courtesy Hadley. Yes, I personally asked him. OK, it was email, but still.</figcaption>
</figure>
</div>
<p>We’ve used <code>select()</code>, <code>mutate()</code> and <code>arrange()</code> already, but we’ll introduce more dplyr functions in this chapter.</p>
<p>We will use these dplyr functions to find the answers to our questions.</p>
</section>
<section id="most-appearances" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="most-appearances"><span class="header-section-number">4.5</span> Most appearances</h2>
<p>Our first question: <strong>Which performer had the most appearances on the Hot 100 chart at any position?</strong></p>
<p>Let’s work through the logic of what we need to do before I explain exactly how to do it.</p>
<p>Each row in the data is one song ranked on the chart. It includes a field with the name of the “performer” so we know who recorded it.</p>
<p><strong>So, to figure out how many times a performer is in the data, we need to count the number of rows with the same performer.</strong></p>
<p>We’ll use the tidyverse’s version of Group and Aggregate to get this answer. It is actually two different functions within dplyr that often work together: <code>group_by()</code> and <code>summarize()</code></p>
<section id="group-aggregate" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="group-aggregate"><span class="header-section-number">4.5.1</span> Group &amp; Aggregate</h3>
<p>Before we dive into the code, let’s review this video about “Group and Aggregate” to get a handle on the concept.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/a3VNWYJoy5A" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
<p><br></p>
<p>We’ll dive deep into this next.</p>
</section>
<section id="summarize" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="summarize"><span class="header-section-number">4.5.2</span> Summarize</h3>
<p>We’ll start with <a href="https://dplyr.tidyverse.org/reference/summarise.html"><code>summarize()</code></a> first because it can stand alone.</p>
<p>The <code>summarize()</code> function <strong>computes summary tables describing your data</strong>. We’re usually finding a single number to describe a column of data, like the “average” of numbers in column.</p>
<p>In our case we want a “summary” about the <strong>number</strong> of times a specific performer appears in data, hence we use <strong><code>summarize()</code></strong>.</p>
<blockquote class="blockquote">
<p>THEY BE THE ZAME: <code>summarize()</code> and <code>summarise()</code> are the same function, as R supports both the American and UK spelling of summarize. They work the same and I don’t care which you use.</p>
</blockquote>
<p>Here is an example of <code>summarize()</code> in a different context:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/transform-summarise.png" class="img-fluid figure-img" width="500"></p>
<figcaption class="figure-caption">Learn about your data with summarize()</figcaption>
</figure>
</div>
<p>The example above is giving us two summaries: It is applying a function <code>mean()</code> (or average) on all the values in the <code>lifeExp</code> column, and then again with <code>min()</code>, the lowest life expectancy in the data.</p>
<p>Much like the <code>mutate()</code> function we used earlier, within <code>summarize()</code> we list the name of the new column first, then assign to it the function and column we want to accomplish using <code>=</code>.</p>
<p>Again, in our case (as we work toward finding the performer with most appearances) we want to summarize the <strong>number</strong> of rows, and there is a function for that: <code>n()</code>. (Think “<strong>n</strong>umber of observations”.) Every row in the data is an appearance … we just need to count how many rows have each performer.</p>
<p>But first, to show how this works, we’ll count <em>all</em> the rows in our data. Let’s write the code and run it, then I’ll explain:</p>
<ol type="1">
<li>Set up a new section with a Markdown headline, text and explain you are looking for most appearances.</li>
<li>Add a named code chunk and add the following:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">appearances =</span> <span class="fu">n</span>()</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  appearances
        &lt;int&gt;
1      336100</code></pre>
</div>
</div>
<ul>
<li>We start with the tibble first and then pipe into <code>summarize()</code>.</li>
<li>Within the function, we define our summary:
<ul>
<li>We name the new column “appearances” because that is a descriptive column name for our result.</li>
<li>We set that new column to count the <strong>n</strong>umber of rows.</li>
</ul></li>
</ul>
<p>Basically we are summarizing the total number of rows in the data. Through 2021 there were 330,800 rows.</p>
<blockquote class="blockquote">
<p>AN ASIDE: Like I did earlier with mutate, I often break up the arguments inside <code>summarize()</code> into new lines so they are easier to read, like above.</p>
</blockquote>
<p>But I bet you’re asking: Professor, we want to count the number of times an <em>performer</em> has appeared, right?</p>
<p>This is where we bring in a close friend to <code>summarize()</code> … the <code>group_by()</code> function.</p>
</section>
<section id="group-by" class="level3" data-number="4.5.3">
<h3 data-number="4.5.3" class="anchored" data-anchor-id="group-by"><span class="header-section-number">4.5.3</span> Group by</h3>
<p>The <a href="https://dplyr.tidyverse.org/reference/group_by.html"><code>group_by()</code></a> function pre-sorts data into groups so that whatever function follows is applied <em>within</em> each of the groups. That means <code>group_by()</code> always has something following it, and that something is <em>usually</em> <code>summarize()</code>.</p>
<p>If we <code>group_by()</code> performer <em>before</em> we summarize/count our rows, it will put all of the rows with “Aerosmith” together, then all the “Bad Company” rows together, etc. and then it will count the rows <em>within</em> those groups … first those for Aerosmith and then those for Bad Company.</p>
<ol type="1">
<li>Modify your code block to add the group_by:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(performer) <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">appearances =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,492 × 2
   performer                  appearances
   &lt;chr&gt;                            &lt;int&gt;
 1 "\"Groove\" Holmes"                 14
 2 "\"Little\" Jimmy Dickens"          10
 3 "\"Pookie\" Hudson"                  1
 4 "\"Weird Al\" Yankovic"             91
 5 "$NOT &amp; A$AP Rocky"                  1
 6 "'N Sync"                          172
 7 "'N Sync &amp; Gloria Estefan"          20
 8 "'N Sync Featuring Nelly"           20
 9 "'Til Tuesday"                      53
10 "(+44)"                              1
# ℹ 10,482 more rows</code></pre>
</div>
</div>
<p>What we get in return is a <strong>summarize</strong>d table that shows all 10,000+ different performers that have been on the charts, and the <strong>n</strong>umber of rows in which they appear in the data.</p>
<p>That’s great, but who had the most?</p>
</section>
<section id="arrange-the-results" class="level3" data-number="4.5.4">
<h3 data-number="4.5.4" class="anchored" data-anchor-id="arrange-the-results"><span class="header-section-number">4.5.4</span> Arrange the results</h3>
<p>Remember in our import notebook when we sorted all the rows by the oldest chart date? We’ll use the same <code>arrange()</code> function here, but we’ll change the result to <strong>desc</strong>ending order, because journalists almost always want to know the <em>most</em> of something.</p>
<ol type="1">
<li><strong>Edit</strong> your chunk to add the pipe and arrange function below and run it, then I’ll explain.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(performer) <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">appearances =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(appearances))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,492 × 2
   performer     appearances
   &lt;chr&gt;               &lt;int&gt;
 1 Taylor Swift         1178
 2 Elton John            889
 3 Madonna               857
 4 Drake                 832
 5 Kenny Chesney         777
 6 Tim McGraw            739
 7 Keith Urban           674
 8 Stevie Wonder         659
 9 Rod Stewart           657
10 Mariah Carey          634
# ℹ 10,482 more rows</code></pre>
</div>
</div>
<ul>
<li>We added the <code>arrange()</code> function and fed it the column of “appearances”. If we left it with just that, then it would list the smallest values first.</li>
<li><em>Within the arrange function</em> we wrapped our column in another function: <code>desc()</code> to change the order to “descending”, or the most on the top.</li>
</ul>
<blockquote class="blockquote">
<p>I sometimes pipe the column name into the <code>desc()</code> function like this: <code>arrange(appearances |&gt; desc())</code>. You can also put a <code>-</code> before the column name like this: <code>arrange(-appearances))</code> but I think is out of favor among tidyverse worldview folk.</p>
</blockquote>
</section>
<section id="get-the-top-of-the-list" class="level3" data-number="4.5.5">
<h3 data-number="4.5.5" class="anchored" data-anchor-id="get-the-top-of-the-list"><span class="header-section-number">4.5.5</span> Get the top of the list</h3>
<p>We’ve printed 10,000+ rows of data into our notebook when we really only wanted the Top 10 or so. You might think it doesn’t matter, but your knitted HTML file will store all that data and can make it a big file (as in hard drive space), so I try to avoid that when I can.</p>
<p>We can use the <code>head()</code> command again to get our Top 10. It will give us a specified number of rows at the top of the table (with a default of six if we don’t specify.) There is a corresponding <code>tail()</code> function to get the last rows.</p>
<ol type="1">
<li>Pipe the result into <code>head()</code> function set to 10 rows.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(performer) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">appearances =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(appearances <span class="sc">|&gt;</span> <span class="fu">desc</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   performer     appearances
   &lt;chr&gt;               &lt;int&gt;
 1 Taylor Swift         1178
 2 Elton John            889
 3 Madonna               857
 4 Drake                 832
 5 Kenny Chesney         777
 6 Tim McGraw            739
 7 Keith Urban           674
 8 Stevie Wonder         659
 9 Rod Stewart           657
10 Mariah Carey          634</code></pre>
</div>
</div>
<p>If I was to explain all of the code above in English, I would describe it as this:</p>
<ul>
<li>We start with the hot100 data AND THEN</li>
<li>we group by the data by performer AND THEN</li>
<li>we summarize it by counting the number of rows in each group, calling the count “appearances” AND THEN</li>
<li>we arrange the result by appearances in descending order AND THEN</li>
<li>we keep just the first 10 rows</li>
</ul>
<p>Since we have our answer here and we’re not using the result later, we don’t need to create a new object or anything. Printing it to our notebook is sufficient.</p>
<p>So, <strong>Taylor Swift</strong> … is that who you guessed? A little history here, Swift past Elton John in the summer of 2019. Elton John has been around a long time, but Swift’s popularity at a young age, plus changes in how Billboard counts plays in the modern era (like streaming) has rocketed her to the top. (Sorry, Rocket Man). And it doesn’t hurt that she is re-releasing her entire catalog (Taylor’s version)!</p>
<blockquote class="blockquote">
<p>AN IMPORTANT NOTE: The list we’ve created here is based on <strong>unique</strong> <code>performer</code> names, and as such considers collaborations separately. For instance, Drake is near the top of the list but those are only songs he performed alone and not the many, many collaborations he has done with other performers. So, songs by “Drake” are counted separately than “Drake featuring Future” and even “Future featuring Drake”. You’ll need to make this clear when you write your data drop in a later assignment.</p>
</blockquote>
</section>
</section>
<section id="titleperformer-combo-with-most-appearances" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="titleperformer-combo-with-most-appearances"><span class="header-section-number">4.6</span> Title/performer combo with most appearances</h2>
<p>Our quest here is this: <strong>Which title/performer combination has been on the charts the most number of weeks at any position?</strong></p>
<p>This is very similar to our quest to find the artist with the most appearances, but we have to consider both <code>title</code> and <code>performer</code> together because different artists can perform songs of the same name. For example, Adele’s song “Hold On” entered the Hot 100 at 49 in December 2021, but 18 different performers have had a song titled “Hold On” on the Hot 100.</p>
<ol type="1">
<li>Start a new section (headline, text describing goal and a new code chunk.)</li>
<li>Add the code below ONE LINE AT A TIME and run it and then I’ll outline it below.</li>
</ol>
<p><strong>WRITE ONE LINE OF CODE. RUN IT. CHECK IT. REPEAT</strong></p>
<p>Remember, you write and run the line <em>BEFORE</em> you add the pipe <code>|&gt;</code>!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span> <span class="co"># start with the data, and then ...</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(performer, title) <span class="sc">|&gt;</span> <span class="co"># group by performer and title, and then ..</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">appearances =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> <span class="co"># count the rows with n(), and then ...</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(appearances)) <span class="co"># arrange by appearances in descending order</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'performer'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30,425 × 3
# Groups:   performer [10,492]
   performer                                 title                   appearances
   &lt;chr&gt;                                     &lt;chr&gt;                         &lt;int&gt;
 1 Glass Animals                             Heat Waves                       91
 2 The Weeknd                                Blinding Lights                  90
 3 Imagine Dragons                           Radioactive                      87
 4 AWOLNATION                                Sail                             79
 5 Jason Mraz                                I'm Yours                        76
 6 LeAnn Rimes                               How Do I Live                    69
 7 LMFAO Featuring Lauren Bennett &amp; GoonRock Party Rock Anthem                68
 8 OneRepublic                               Counting Stars                   68
 9 Adele                                     Rolling In The Deep              65
10 Jewel                                     Foolish Games/You Were…          65
# ℹ 30,415 more rows</code></pre>
</div>
</div>
<p>The logic works like this:</p>
<ul>
<li>We want to count combinations over two columns: <code>title, performer</code>. When you group_by more then one column, it will group rows where the values are the same in all columns. i.e.&nbsp;all rows with both “Rush” as a performer and <em>Tom Sawyer</em> as a title are in the same group. Rows with “Rush” and <em>Red Barchetta</em> will be considered in a different group.</li>
<li>Within <code>summarize()</code>, we can name the new column first (we chose <code>appearances</code> as a name here), then describe what should fill it. In this case we filled the column using the <code>n()</code>, which counts the <strong>n</strong>umber of rows in each group.</li>
<li>Once you have a summary table, we sort it by appearances and set it to <strong>desc</strong>ending order, which puts the highest value on the top.</li>
</ul>
<p>We will <em>often</em> use <code>group_by()</code>, <code>summarize()</code> and <code>arrange()</code> together, which is why I’ll refer to this as the <strong>GSA trio</strong>. They are like three close friends that always want to hang out together.</p>
<p>So, what was your guess or this one? A little bit of history in that answer … The Weeknd’s <em>Blinding Lights</em> passed Imagine Dragon’s <em>Radioactive</em> some time in 2021, but then Glass Animals’ <em>Heat Waves</em> topped the chart in 2022.</p>
<section id="introducing-filter" class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" class="anchored" data-anchor-id="introducing-filter"><span class="header-section-number">4.6.1</span> Introducing filter()</h3>
<p>I showed you <code>head()</code> in the previous quest and that was useful to quickly limit that list, but it does so indiscriminately. In this case, if we use the default <code>head()</code> function that retains six rows, it would cut right in the middle of a tie at 68 records (at least with data through 2021). A better strategy is to cut off the list at a logical place using <code>filter()</code>. Let’s dive into this new function:</p>
<p>Filtering is one of those Basic Data Journalism Functions:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/ckojM4rtlMc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
<p><br></p>
<p>The dplyr function <code>filter()</code> reduces the number of rows in our data based on one or more criteria within the data.</p>
<p>The syntax works like this:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this is psuedo code. don't run it</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable comparison value)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># example</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span> </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(performer <span class="sc">==</span> <span class="st">"Judas Priest"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>filter()</code> function typically works in this order:</p>
<ul>
<li>What is the variable (or column) you are searching in.</li>
<li>What is the comparison you want to do. Equal to? Greater than?</li>
<li>What is the observation (or value in the data) you are looking for?</li>
</ul>
<p>Note the two equals signs <code>==</code> in our Judas Priest example above. It’s important to use two of them when you are asking if a value is “true” or “equal to”, as a single <code>=</code> typically means you are assigning a value to something.</p>
<section id="comparisons-logical-tests" class="level4" data-number="4.6.1.1">
<h4 data-number="4.6.1.1" class="anchored" data-anchor-id="comparisons-logical-tests"><span class="header-section-number">4.6.1.1</span> Comparisons: Logical tests</h4>
<p>There are a number of these logical tests for the comparison:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Operator</th>
<th style="text-align: left;">Definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">x <strong>&lt;</strong> y</td>
<td style="text-align: left;">Less than</td>
</tr>
<tr class="even">
<td style="text-align: left;">x <strong>&gt;</strong> y</td>
<td style="text-align: left;">Greater than</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x <strong>==</strong> y</td>
<td style="text-align: left;">Equal to</td>
</tr>
<tr class="even">
<td style="text-align: left;">x <strong>&lt;=</strong> y</td>
<td style="text-align: left;">Less than or equal to</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x <strong>&gt;=</strong> y</td>
<td style="text-align: left;">Greater than or equal to</td>
</tr>
<tr class="even">
<td style="text-align: left;">x <strong>!-</strong> y</td>
<td style="text-align: left;">Not equal to</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x <strong>%in%</strong> c(y,z)</td>
<td style="text-align: left;">In a group</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>is.na(</strong>x<strong>)</strong></td>
<td style="text-align: left;">Is NA (missing values)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>!is.na(</strong>x<strong>)</strong></td>
<td style="text-align: left;">Is not NA</td>
</tr>
</tbody>
</table>
<p>Where you apply a filter matters. If we filter before group by/summarize/arrange (GSA) we are focusing the data before we summarize. If we filter after the GSA, we are affecting only the results of the summarize function, which is what we want to do here.</p>
</section>
<section id="filter-to-a-logical-cutoff" class="level4" data-number="4.6.1.2">
<h4 data-number="4.6.1.2" class="anchored" data-anchor-id="filter-to-a-logical-cutoff"><span class="header-section-number">4.6.1.2</span> Filter to a logical cutoff</h4>
<p>In this case, I want you to use filter <em>after</em> the GSA actions to include <strong>only results with 65 or more appearances</strong>.</p>
<ol type="1">
<li><strong>Edit</strong> your current chunk to add a filter as noted in the example below. I’ll explain it after.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(performer, title) <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">appearances =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(appearances <span class="sc">|&gt;</span> <span class="fu">desc</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(appearances <span class="sc">&gt;=</span> <span class="dv">65</span>) <span class="co"># this is the new line</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'performer'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
# Groups:   performer [10]
   performer                                 title                   appearances
   &lt;chr&gt;                                     &lt;chr&gt;                         &lt;int&gt;
 1 Glass Animals                             Heat Waves                       91
 2 The Weeknd                                Blinding Lights                  90
 3 Imagine Dragons                           Radioactive                      87
 4 AWOLNATION                                Sail                             79
 5 Jason Mraz                                I'm Yours                        76
 6 LeAnn Rimes                               How Do I Live                    69
 7 LMFAO Featuring Lauren Bennett &amp; GoonRock Party Rock Anthem                68
 8 OneRepublic                               Counting Stars                   68
 9 Adele                                     Rolling In The Deep              65
10 Jewel                                     Foolish Games/You Were…          65</code></pre>
</div>
</div>
<p>Let’s break down that last line:</p>
<ul>
<li><code>filter()</code> is the function.</li>
<li>The first argument in the function is the column we are looking in, <code>appearances</code> in our case.</li>
<li>We then provide a comparison operator <code>&gt;=</code> to get “greater than or equal to”.</li>
<li>We then give the value to compare, <code>65</code> in our case.</li>
</ul>
</section>
</section>
</section>
<section id="titleperformer-with-most-weeks-at-no.-1" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="titleperformer-with-most-weeks-at-no.-1"><span class="header-section-number">4.7</span> Title/Performer with most weeks at No.&nbsp;1</h2>
<p>We introduced <code>filter()</code> in the last quest to limit the summary. For this quest you’ll need to filter the data <em>before</em> the group by/summarize/arrange trio.</p>
<p>Let’s review the quest: <strong>Which performer/title combination was No.&nbsp;1 for the most number of weeks?</strong></p>
<p>While this quest is very similar to the one above, it <em>really</em> helps to think about the logic of what you need and then build the query <strong>one line at a time</strong> to make each line works.</p>
<p>Let’s talk through the logic:</p>
<ul>
<li>We are starting with our <code>hot100</code> data.</li>
<li>Do we want to consider all the data? In this case, no: We only want titles that have a <code>current_rank</code> of 1. This means we will <strong>filter</strong> before any summarizing.</li>
<li>Then we want to count the number of rows with the same <strong>performer</strong> and <strong>title</strong> combinations. This means we need to <code>group_by</code> both <code>performer</code> and <code>title</code>.</li>
<li>Since we are <strong>counting rows</strong>, we need use <code>n()</code> as our summarize function, which counts the <strong>number</strong> or rows in each group.</li>
</ul>
<p>So let’s step through this with code:</p>
<ol type="1">
<li>Create a section with a headline, text and code chunk</li>
<li>Start with the <code>hot100</code> data and then pipe into <code>filter()</code>.</li>
<li>Within the filter, set the <code>current_rank</code> to be <code>==</code> to <code>1</code>.</li>
<li>Run the result and check it</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(current_rank <span class="sc">==</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,361 × 7
   chart_date current_rank title  performer previous_rank peak_rank wks_on_chart
   &lt;date&gt;            &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;
 1 1958-08-04            1 Poor … Ricky Ne…            NA         1            1
 2 1958-08-11            1 Poor … Ricky Ne…             1         1            2
 3 1958-08-18            1 Nel B… Domenico…             2         1            3
 4 1958-08-25            1 Littl… The Eleg…             2         1            4
 5 1958-09-01            1 Nel B… Domenico…             2         1            5
 6 1958-09-08            1 Nel B… Domenico…             1         1            6
 7 1958-09-15            1 Nel B… Domenico…             1         1            7
 8 1958-09-22            1 Nel B… Domenico…             1         1            8
 9 1958-09-29            1 It's … Tommy Ed…             3         1            7
10 1958-10-06            1 It's … Tommy Ed…             1         1            8
# ℹ 3,351 more rows</code></pre>
</div>
</div>
<p>The result should show <em>only</em> titles with a <code>1</code> for <code>current_rank</code>.</p>
<p>The rest of our logic is just like our last quest. We need to group by the <code>title</code> and <code>performer</code> and then <code>summarize</code> using <code>n()</code> to count the rows.</p>
<ol type="1">
<li>Edit your existing chunk to add the <code>group_by</code> and <code>summarize</code> functions. Name your new column <code>appearances</code> and set it to count the rows with <code>n()</code>.</li>
</ol>
<blockquote class="blockquote">
<p>While <strong>ONE LINE AT A TIME</strong> is still “the Way”, <code>group_by()</code> won’t actually show you any different results that without it, so I usually write <code>group_by()</code> and <code>summarize()</code> together. Or I write the <code>summarize()</code> line first to make sure it works, then edit in the <code>group_by()</code> line to split the data before the summary.</p>
</blockquote>
<details>
<summary>
Try this on your own before you peek for the answer
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(current_rank <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(performer, title) <span class="sc">|&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">appearances =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'performer'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,144 × 3
# Groups:   performer [757]
   performer                          title                          appearances
   &lt;chr&gt;                              &lt;chr&gt;                                &lt;int&gt;
 1 'N Sync                            It's Gonna Be Me                         2
 2 24kGoldn Featuring iann dior       Mood                                     8
 3 2Pac Featuring K-Ci And JoJo       How Do U Want It/California L…           2
 4 50 Cent                            In Da Club                               9
 5 50 Cent Featuring Nate Dogg        21 Questions                             4
 6 50 Cent Featuring Olivia           Candy Shop                               9
 7 6ix9ine &amp; Nicki Minaj              Trollz                                   1
 8 ? (Question Mark) &amp; The Mysterians 96 Tears                                 1
 9 A Taste Of Honey                   Boogie Oogie Oogie                       3
10 ABBA                               Dancing Queen                            1
# ℹ 1,134 more rows</code></pre>
</div>
</div>
</details>
<p>Look at your results to make sure you have the three columns you expect: performer, title and appearances.</p>
<p>This doesn’t quite get us where we want because it lists the results alphabetically by the performer. You need to <strong>arrange</strong> the data to show us the most appearances at the top.</p>
<ol type="1">
<li><strong>Edit</strong> your chunk to add the <code>arrange()</code> function to sort by <code>appearances</code> in <code>desc()</code> order. This is just like our last quest.</li>
</ol>
<details>
<summary>
Maybe check your last chunk on how you used arrange, then try it before checking the answer here.
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(current_rank <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(performer, title) <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">appearances =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(appearances <span class="sc">|&gt;</span> <span class="fu">desc</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'performer'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,144 × 3
# Groups:   performer [757]
   performer                                         title           appearances
   &lt;chr&gt;                                             &lt;chr&gt;                 &lt;int&gt;
 1 Lil Nas X Featuring Billy Ray Cyrus               Old Town Road            19
 2 Luis Fonsi &amp; Daddy Yankee Featuring Justin Bieber Despacito                16
 3 Mariah Carey &amp; Boyz II Men                        One Sweet Day            16
 4 Harry Styles                                      As It Was                15
 5 Boyz II Men                                       I'll Make Love…          14
 6 Elton John                                        Candle In The …          14
 7 Los Del Rio                                       Macarena (Bays…          14
 8 Mariah Carey                                      We Belong Toge…          14
 9 Mark Ronson Featuring Bruno Mars                  Uptown Funk!             14
10 The Black Eyed Peas                               I Gotta Feeling          14
# ℹ 1,134 more rows</code></pre>
</div>
</div>
</details>
<p>You have your answer now (you go, Lil Nas) but we are listing more than 1,000 rows. Let’s cut this off at a logical place like we did in our last quest.</p>
<ol type="1">
<li>Use <code>filter()</code> to cut your summary off at <code>appearances</code> of 14 or greater.</li>
</ol>
<details>
<summary>
You’ve done this before … try it on your own!
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(current_rank <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(performer, title) <span class="sc">|&gt;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">appearances =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(appearances <span class="sc">|&gt;</span> <span class="fu">desc</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(appearances <span class="sc">&gt;=</span> <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'performer'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 3
# Groups:   performer [11]
   performer                                         title           appearances
   &lt;chr&gt;                                             &lt;chr&gt;                 &lt;int&gt;
 1 Lil Nas X Featuring Billy Ray Cyrus               Old Town Road            19
 2 Luis Fonsi &amp; Daddy Yankee Featuring Justin Bieber Despacito                16
 3 Mariah Carey &amp; Boyz II Men                        One Sweet Day            16
 4 Harry Styles                                      As It Was                15
 5 Boyz II Men                                       I'll Make Love…          14
 6 Elton John                                        Candle In The …          14
 7 Los Del Rio                                       Macarena (Bays…          14
 8 Mariah Carey                                      We Belong Toge…          14
 9 Mark Ronson Featuring Bruno Mars                  Uptown Funk!             14
10 The Black Eyed Peas                               I Gotta Feeling          14
11 Whitney Houston                                   I Will Always …          14</code></pre>
</div>
</div>
</details>
<p>Now you have the answers to the performer/title with the most weeks at No.&nbsp;1 with a logical cutoff. If you add to the data later, that logic will still hold and not cut off arbitrarily at a certain number of records.</p>
</section>
<section id="performer-with-most-titles-to-reach-no.-1" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="performer-with-most-titles-to-reach-no.-1"><span class="header-section-number">4.8</span> Performer with most titles to reach No.&nbsp;1</h2>
<p>Our new quest is this: <strong>Which performer had the most titles reach No.&nbsp;1?</strong> The answer might be easier to guess if you know music history, but perhaps not.</p>
<p>This sounds similar to our last quest, but there is a <strong>distinct</strong> difference. (That’s a bad joke that will reveal itself here in a bit.)</p>
<p>Again, let’s think through the logic of what we have to do to get our answer:</p>
<ul>
<li>We need to consider only No.&nbsp;1 songs (filter!)</li>
<li>Because a song could be No.&nbsp;1 for more than one week, we need to consider the same title/performer combination only once. Another way to say this is we need unique or distinct combinations of title/performer. (We’ll introduce a new function to find this.)</li>
<li>Once we have all the unique No.&nbsp;1 songs in a list, then we can group by <strong>performer</strong> and count the <strong>n</strong>umber of times they are on the list.</li>
</ul>
<p>Let’s start by getting the No.&nbsp;1 songs. You’ve did this in the last quest.</p>
<ol type="1">
<li>Create a new section with a headline, text and code chunk.</li>
<li>Start with the <code>hot100</code> data and filter it so you only have <code>current_rank</code> of 1.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(current_rank <span class="sc">==</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,361 × 7
   chart_date current_rank title  performer previous_rank peak_rank wks_on_chart
   &lt;date&gt;            &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;
 1 1958-08-04            1 Poor … Ricky Ne…            NA         1            1
 2 1958-08-11            1 Poor … Ricky Ne…             1         1            2
 3 1958-08-18            1 Nel B… Domenico…             2         1            3
 4 1958-08-25            1 Littl… The Eleg…             2         1            4
 5 1958-09-01            1 Nel B… Domenico…             2         1            5
 6 1958-09-08            1 Nel B… Domenico…             1         1            6
 7 1958-09-15            1 Nel B… Domenico…             1         1            7
 8 1958-09-22            1 Nel B… Domenico…             1         1            8
 9 1958-09-29            1 It's … Tommy Ed…             3         1            7
10 1958-10-06            1 It's … Tommy Ed…             1         1            8
# ℹ 3,351 more rows</code></pre>
</div>
</div>
<p>Now look at the result. Note how “Poor Little Fool” shows up more than once? Other songs do as well. If we counted rows by <code>performer</code> now, that would tell us the number of weeks they’ve had No.&nbsp;1 songs, not how many <em>different</em> songs have made No.&nbsp;1.</p>
<section id="using-distinct" class="level3" data-number="4.8.1">
<h3 data-number="4.8.1" class="anchored" data-anchor-id="using-distinct"><span class="header-section-number">4.8.1</span> Using distinct()</h3>
<p>The next challenge in our logic is to show only unique performer/title combinations. We do this with <a href="https://dplyr.tidyverse.org/reference/distinct.html"><code>distinct()</code></a>.</p>
<p>We feed the <code>distinct()</code> function with the variables we want to consider together, in our case the <code>perfomer</code> and <code>title</code>. All other columns are dropped since including them would mess up their distinctness.</p>
<ol type="1">
<li><strong>Edit</strong> your chunk to add the <code>distinct()</code> function to your code chunk.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(current_rank <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(title, performer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,144 × 2
   title                           performer                       
   &lt;chr&gt;                           &lt;chr&gt;                           
 1 Poor Little Fool                Ricky Nelson                    
 2 Nel Blu Dipinto Di Blu (Volaré) Domenico Modugno                
 3 Little Star                     The Elegants                    
 4 It's All In The Game            Tommy Edwards                   
 5 It's Only Make Believe          Conway Twitty                   
 6 Tom Dooley                      The Kingston Trio               
 7 To Know Him, Is To Love Him     The Teddy Bears                 
 8 The Chipmunk Song               The Chipmunks With David Seville
 9 Smoke Gets In Your Eyes         The Platters                    
10 Stagger Lee                     Lloyd Price                     
# ℹ 1,134 more rows</code></pre>
</div>
</div>
<p>Now we have a list of just No.&nbsp;1 songs!</p>
</section>
<section id="summarize-the-performers" class="level3" data-number="4.8.2">
<h3 data-number="4.8.2" class="anchored" data-anchor-id="summarize-the-performers"><span class="header-section-number">4.8.2</span> Summarize the performers</h3>
<p>Now that we have our list of No.&nbsp;1 songs, we can summarize the “number” of times a performer is in the list to know how many No.&nbsp;1 songs they have.</p>
<p>We’ll again use the group_by/summarize/arrange combination for this, but we are only grouping by <code>performer</code> since that is the values we are counting.</p>
<ol type="1">
<li><strong>Edit</strong> your chunk to add a group_by on <code>performer</code> and then a <code>summarize()</code> to count the rows. Name the new column <code>no_hits</code>. Run it.</li>
<li>After you are sure the group_by/summarize runs, add an <code>arrange()</code> to show the <code>no1_hits</code> in descending order.</li>
</ol>
<details>
<summary>
You’ve done this before! Give it a go before checking the code here.
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(current_rank <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(title, performer) <span class="sc">|&gt;</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(performer) <span class="sc">|&gt;</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">no1_hits =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(no1_hits <span class="sc">|&gt;</span> <span class="fu">desc</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 757 × 2
   performer          no1_hits
   &lt;chr&gt;                 &lt;int&gt;
 1 The Beatles              19
 2 Mariah Carey             16
 3 Madonna                  12
 4 Michael Jackson          11
 5 Whitney Houston          11
 6 The Supremes             10
 7 Bee Gees                  9
 8 Taylor Swift              8
 9 The Rolling Stones        8
10 Janet Jackson             7
# ℹ 747 more rows</code></pre>
</div>
</div>
</details>
</section>
<section id="filter-for-a-good-cutoff" class="level3" data-number="4.8.3">
<h3 data-number="4.8.3" class="anchored" data-anchor-id="filter-for-a-good-cutoff"><span class="header-section-number">4.8.3</span> Filter for a good cutoff</h3>
<p>Like we did earlier, use a <code>filter()</code> after your arrange to cut the list off at a logical place.</p>
<ol type="1">
<li>Edit your chunk to filter the summary to show performers with <code>8</code> or more No.&nbsp;1 hits.</li>
</ol>
<details>
<summary>
You can do this. Really.
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(current_rank <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(title, performer) <span class="sc">|&gt;</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(performer) <span class="sc">|&gt;</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">no1_hits =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(no1_hits <span class="sc">|&gt;</span> <span class="fu">desc</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(no1_hits <span class="sc">&gt;=</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 2
  performer          no1_hits
  &lt;chr&gt;                 &lt;int&gt;
1 The Beatles              19
2 Mariah Carey             16
3 Madonna                  12
4 Michael Jackson          11
5 Whitney Houston          11
6 The Supremes             10
7 Bee Gees                  9
8 Taylor Swift              8
9 The Rolling Stones        8</code></pre>
</div>
</div>
</details>
<p>So, <strong>The Beatles</strong>. Was that your guess? Look closely at that list … who has any chance of topping them?</p>
</section>
</section>
<section id="no.-1-hits-in-last-five-years" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="no.-1-hits-in-last-five-years"><span class="header-section-number">4.9</span> No.&nbsp;1 hits in last five years</h2>
<p><strong>Which performer had the most songs reach No.&nbsp;1 in the most recent five years?</strong></p>
<p>Let’s talk through the logic. This is very similar to the No.&nbsp;1 hits above but with two differences:</p>
<ul>
<li>In addition to filtering for No.&nbsp;1 songs, we also want to filter for songs in 2018-2022.</li>
<li>We might need to adjust our last filter for a better “break point”.</li>
</ul>
<p>We haven’t talked about filtering dates, so let me tell you this: You can use filter operations on dates just like you do any other text. This will give you rows <em>after</em> the last day of 2017.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(chart_date <span class="sc">&gt;</span> <span class="st">"2017-12-31"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>But since we need this filter before our group, we can do this within the same filter function where we get the number one songs.</p>
<ol type="1">
<li>Create a new section (headline, text, chunk).</li>
<li>Build (from scratch, one line at a time) the same filter, group_by, summarize and arrange as above, but <strong>leave out the cut-off filter</strong> at the end. Make sure it runs.</li>
<li><strong>Edit your filter</strong> to put a comma after <code>current_rank == 1</code> and then add this filter: <code>chart_date &gt; "2017-12-31"</code>. Run the code.</li>
<li>Build a new cut-off filter at the end and keep only rows with more than 1 <code>top_hits</code>.</li>
</ol>
<details>
<summary>
No, really. Try it on your own first.
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    current_rank <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    chart_date <span class="sc">&gt;</span> <span class="st">"2017-12-31"</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(title, performer) <span class="sc">|&gt;</span> </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(performer) <span class="sc">|&gt;</span> </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">top_hits =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(top_hits <span class="sc">|&gt;</span> <span class="fu">desc</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(top_hits <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 2
  performer      top_hits
  &lt;chr&gt;             &lt;int&gt;
1 Drake                 5
2 BTS                   4
3 Taylor Swift          4
4 Ariana Grande         3
5 Harry Styles          2
6 Lizzo                 2
7 Olivia Rodrigo        2
8 The Weeknd            2
9 Travis Scott          2</code></pre>
</div>
</div>
</details>
</section>
<section id="top-10-hits-overall-on-your-own" class="level2" data-number="4.10">
<h2 data-number="4.10" class="anchored" data-anchor-id="top-10-hits-overall-on-your-own"><span class="header-section-number">4.10</span> Top 10 hits overall (on your own)</h2>
<p>Which performer had the most Top 10 hits overall?</p>
<p>This one I want you to do on your own.</p>
<p>The logic is very similar to the “Most No.&nbsp;1 hits” quest you did before, but you need to adjust your filter to find songs within position 1 through 10. Don’t over think it, but do recognize that the “top” of the charts are smaller numbers, not larger ones.</p>
<ol type="1">
<li>Make a new section</li>
<li>Describe what you are doing</li>
<li>Do it using the group_by/summarize method</li>
<li>Filter to cut off at a logical number or rows. (i.e., don’t stop at a tie)</li>
</ol>
</section>
<section id="complex-filters" class="level2" data-number="4.11">
<h2 data-number="4.11" class="anchored" data-anchor-id="complex-filters"><span class="header-section-number">4.11</span> Complex filters</h2>
<p>You can combine filters in different ways to really target which rows to keep. For these I want you to play around a bit.</p>
<ol type="1">
<li>Copy <strong>each of the examples below</strong> into your notebook, but change the title and/or artists to some that you like.</li>
</ol>
<section id="multiple-truths" class="level3" data-number="4.11.1">
<h3 data-number="4.11.1" class="anchored" data-anchor-id="multiple-truths"><span class="header-section-number">4.11.1</span> Multiple truths</h3>
<p>If you want filter data for when <strong>two or more things are true</strong>, you can write two equations and combine with <code>&amp;</code>. Only rows where both sides prove true are returned.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># When Poor Little Fool was No. 1, but not any other position</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(title <span class="sc">==</span> <span class="st">"Poor Little Fool"</span> <span class="sc">&amp;</span> current_rank <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(chart_date<span class="sc">:</span>performer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  chart_date current_rank title            performer   
  &lt;date&gt;            &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;       
1 1958-08-04            1 Poor Little Fool Ricky Nelson
2 1958-08-11            1 Poor Little Fool Ricky Nelson</code></pre>
</div>
</div>
</section>
<section id="either-is-true" class="level3" data-number="4.11.2">
<h3 data-number="4.11.2" class="anchored" data-anchor-id="either-is-true"><span class="header-section-number">4.11.2</span> Either is true</h3>
<p>If you want an <strong>or</strong> filter, then you write two equations with a <code>|</code> between them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># songs by Adam Sandler OR Alabama Shakes</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(performer <span class="sc">==</span> <span class="st">"Adam Sandler"</span> <span class="sc">|</span> performer <span class="sc">==</span> <span class="st">"Alabama Shakes"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(chart_date<span class="sc">:</span>performer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  chart_date current_rank title             performer     
  &lt;date&gt;            &lt;dbl&gt; &lt;chr&gt;             &lt;chr&gt;         
1 1999-01-02           80 The Chanukah Song Adam Sandler  
2 1999-01-09           98 The Chanukah Song Adam Sandler  
3 2013-03-02          100 Hold On           Alabama Shakes
4 2013-03-09           93 Hold On           Alabama Shakes</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><code>|</code> is the <em>Shift</em> of the <code>\</code> key above Return on your keyboard. That <code>|</code> character is also sometimes called a “pipe”, which gets confusing in R with <code>|&gt;</code>.)</p>
</blockquote>
</section>
<section id="mixing-criteria" class="level3" data-number="4.11.3">
<h3 data-number="4.11.3" class="anchored" data-anchor-id="mixing-criteria"><span class="header-section-number">4.11.3</span> Mixing criteria</h3>
<p>If you have <strong>multiple criteria</strong>, you separate them with a comma <code>,</code>. Note I’ve also added returns to make the code more readable and added distinct to songs only once.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gives us rows with either Taylor Swift or Drake,</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># but only those that reached No. 1</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    performer <span class="sc">==</span> <span class="st">"Taylor Swift"</span> <span class="sc">|</span> performer <span class="sc">==</span> <span class="st">"Drake"</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    current_rank <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(current_rank, title, performer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 3
   current_rank title                                   performer   
          &lt;dbl&gt; &lt;chr&gt;                                   &lt;chr&gt;       
 1            1 We Are Never Ever Getting Back Together Taylor Swift
 2            1 Shake It Off                            Taylor Swift
 3            1 Blank Space                             Taylor Swift
 4            1 Look What You Made Me Do                Taylor Swift
 5            1 God's Plan                              Drake       
 6            1 Nice For What                           Drake       
 7            1 In My Feelings                          Drake       
 8            1 Toosie Slide                            Drake       
 9            1 Cardigan                                Taylor Swift
10            1 Willow                                  Taylor Swift
11            1 What's Next                             Drake       
12            1 All Too Well (Taylor's Version)         Taylor Swift
13            1 Anti-Hero                               Taylor Swift</code></pre>
</div>
</div>
</section>
<section id="search-within-a-string" class="level3" data-number="4.11.4">
<h3 data-number="4.11.4" class="anchored" data-anchor-id="search-within-a-string"><span class="header-section-number">4.11.4</span> Search within a string</h3>
<p>And if you want to search for text <strong>within</strong> the data, you can use <a href="https://stringr.tidyverse.org/reference/str_detect.html"><code>str_detect()</code></a> to look for specific characters within a value to filter rows. <code>str_detect()</code> needs two arguments: 1) What column to search in, and 2) what to search for “in quotes”. I also use <code>distinct()</code> here to show only unique title/performer combinations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Songs where "2 Chainz" was among performers</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(performer, <span class="st">"2 Chainz"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(title, performer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 2
   title                  performer                                            
   &lt;chr&gt;                  &lt;chr&gt;                                                
 1 Mercy                  Kanye West, Big Sean, Pusha T, 2 Chainz              
 2 Beez In The Trap       Nicki Minaj Featuring 2 Chainz                       
 3 No Lie                 2 Chainz Featuring Drake                             
 4 Birthday Song          2 Chainz Featuring Kanye West                        
 5 Yuck!                  2 Chainz Featuring Lil Wayne                         
 6 Bandz A Make Her Dance Juicy J Featuring Lil Wayne &amp; 2 Chainz               
 7 My Moment              DJ Drama Featuring 2 Chainz, Meek Mill &amp; Jeremih     
 8 F**kin Problems        A$AP Rocky Featuring Drake, 2 Chainz &amp; Kendrick Lamar
 9 I'm Different          2 Chainz                                             
10 R.I.P.                 Young Jeezy Featuring 2 Chainz                       
# ℹ 30 more rows</code></pre>
</div>
</div>
<p>There is a newer string search function called <code>str_like()</code> that has some <a href="https://stringr.tidyverse.org/reference/str_like.html">interesting nuances</a> derived from SQL. It must match the entire phrase so it will find only songs where “2 Chainz” is the only artist, but it case INSENSITIVE by default, unlike <code>str_detect()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_like</span>(performer, <span class="st">"2 chainz"</span>)) <span class="sc">|&gt;</span> <span class="co"># note chainz is lowercase in the search string</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(title, performer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  title         performer
  &lt;chr&gt;         &lt;chr&gt;    
1 I'm Different 2 Chainz 
2 Watch Out     2 Chainz </code></pre>
</div>
</div>
<p>Of course there is much, much more.</p>
</section>
</section>
<section id="on-your-own" class="level2" data-number="4.12">
<h2 data-number="4.12" class="anchored" data-anchor-id="on-your-own"><span class="header-section-number">4.12</span> On your own</h2>
<p>Now I want you to find something else on your own. It doesn’t matter what it is. Just find something about a performer or song you like.</p>
<ol type="1">
<li>Start a new section with a Markdown headline</li>
<li>Use Markdown text to declare what you are looking for</li>
<li>Find it!</li>
<li>After your code, explain what functions you used and why (like what did they do for you)</li>
</ol>
</section>
<section id="a-shortcut-count" class="level2" data-number="4.13">
<h2 data-number="4.13" class="anchored" data-anchor-id="a-shortcut-count"><span class="header-section-number">4.13</span> A shortcut: count()</h2>
<p>In the interest of full disclosure but at the risk of confusing you, I must reveal this fact:</p>
<p>We count stuff in data science (and journalism) all the time. So dplyr has a shortcut to group, count and arrange rows of data. We needed to use the long way above because a) we will use <code>group_by()</code> and <code>summarize()</code> with other math that isn’t just counting rows, and b) you need to understand what is happening inside <code>count()</code>, which uses group_by/summarize/arrange under the hood.</p>
<p>The <a href="https://dplyr.tidyverse.org/reference/count.html"><code>count()</code></a> function takes the columns you want to group and then does the summarize on <code>n()</code> for you:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(performer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,492 × 2
   performer                      n
   &lt;chr&gt;                      &lt;int&gt;
 1 "\"Groove\" Holmes"           14
 2 "\"Little\" Jimmy Dickens"    10
 3 "\"Pookie\" Hudson"            1
 4 "\"Weird Al\" Yankovic"       91
 5 "$NOT &amp; A$AP Rocky"            1
 6 "'N Sync"                    172
 7 "'N Sync &amp; Gloria Estefan"    20
 8 "'N Sync Featuring Nelly"     20
 9 "'Til Tuesday"                53
10 "(+44)"                        1
# ℹ 10,482 more rows</code></pre>
</div>
</div>
<p>To get the same pretty table you still have to rename the new column and reverse the sort, you just do it differently as arguments within the <code>count()</code> function. You can view the <a href="https://dplyr.tidyverse.org/reference/count.html"><code>count()</code> options here.</a></p>
<ul>
<li>Add this chunk to your notebook (with a note you are trying <code>count()</code>) so you have it to refer to.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(performer, <span class="at">name =</span> <span class="st">"appearances"</span>, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(appearances <span class="sc">&gt;</span> <span class="dv">600</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 2
   performer       appearances
   &lt;chr&gt;                 &lt;int&gt;
 1 Taylor Swift           1178
 2 Elton John              889
 3 Madonna                 857
 4 Drake                   832
 5 Kenny Chesney           777
 6 Tim McGraw              739
 7 Keith Urban             674
 8 Stevie Wonder           659
 9 Rod Stewart             657
10 Mariah Carey            634
11 Michael Jackson         613
12 Chicago                 607
13 Rascal Flatts           604</code></pre>
</div>
</div>
<p>So the code above does same things here as we did in our first quest, but quicker.</p>
<blockquote class="blockquote">
<p>IMPORTANT: We will concentrate on using group_by/summarize/arrange because it can do SO MUCH MORE than <code>count()</code>. Count can ONLY count rows. It can’t do any other kind of math in summarize.</p>
</blockquote>
</section>
<section id="review-of-what-weve-learned" class="level2" data-number="4.14">
<h2 data-number="4.14" class="anchored" data-anchor-id="review-of-what-weve-learned"><span class="header-section-number">4.14</span> Review of what we’ve learned</h2>
<p>We introduced a number of new functions in this lesson, most of them from the <a href="https://dplyr.tidyverse.org/">dplyr</a> package. Mostly we filtered and summarized our data. Here are the functions we introduced in this chapter, many with links to documentation:</p>
<ul>
<li><a href="https://dplyr.tidyverse.org/reference/filter.html"><code>filter()</code></a> returns only rows that meet logical criteria you specify.</li>
<li><a href="https://dplyr.tidyverse.org/reference/summarise.html"><code>summarize()</code></a> builds a summary table <em>about</em> your data. You can count rows <a href="https://dplyr.tidyverse.org/reference/n.html"><code>n()</code></a> or do math on numerical values, like <code>mean()</code>.</li>
<li><a href="https://dplyr.tidyverse.org/reference/group_by.html"><code>group_by()</code></a> is often used with <code>summarize()</code> to put data into groups before building a summary table based on the groups.</li>
<li><a href="https://dplyr.tidyverse.org/reference/distinct.html"><code>distinct()</code></a> returns rows based on unique values in columns you specify. i.e., it deduplicates data.</li>
<li><a href="https://stringr.tidyverse.org/reference/str_detect.html"><code>str_detect()</code></a> and <a href="https://stringr.tidyverse.org/reference/str_like.html"><code>str_like()</code></a> to search within strings.</li>
<li><a href="https://dplyr.tidyverse.org/reference/count.html"><code>count()</code></a> is a shorthand for the group_by/summarize operation to count rows based on groups. You can name your summary columns and sort the data within the same function.</li>
</ul>
</section>
<section id="turn-in-your-project" class="level2" data-number="4.15">
<h2 data-number="4.15" class="anchored" data-anchor-id="turn-in-your-project"><span class="header-section-number">4.15</span> Turn in your project</h2>
<ol type="1">
<li>Make sure everything runs properly (Restart R and Run All Chunks) and then Knit to HTML.</li>
<li>Zip the folder.</li>
<li>Upload to the Canvas assignment.</li>
</ol>
</section>
<section id="soundtrack-for-this-assignment" class="level2" data-number="4.16">
<h2 data-number="4.16" class="anchored" data-anchor-id="soundtrack-for-this-assignment"><span class="header-section-number">4.16</span> Soundtrack for this assignment</h2>
<p>This lesson was constructed with the vibes of <a href="https://www.thebrightlightsocialhour.com/home">The Bright Light Social Hour</a>. They’ve never had a song on the Hot 100 (at least not through 2021).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>hot100 <span class="sc">|&gt;</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(performer, <span class="st">"Bright Light"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 7
# ℹ 7 variables: chart_date &lt;date&gt;, current_rank &lt;dbl&gt;, title &lt;chr&gt;,
#   performer &lt;chr&gt;, previous_rank &lt;dbl&gt;, peak_rank &lt;dbl&gt;, wks_on_chart &lt;dbl&gt;</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./counts-import.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Summarize: count - import</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./sums-import.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Summarize: math - import</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>