<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 7 Graphics | Reporting with Data in R</title>
  <meta name="description" content="Chapter 7 Graphics | Reporting with Data in R is a series of lessons for a course in the School of Journalism, Moody College of Communication at the University of Texas at Austin. It is taught by Christian McDonald.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 7 Graphics | Reporting with Data in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 7 Graphics | Reporting with Data in R is a series of lessons for a course in the School of Journalism, Moody College of Communication at the University of Texas at Austin. It is taught by Christian McDonald." />
  <meta name="github-repo" content="utdata/rwd-class" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Graphics | Reporting with Data in R" />
  
  <meta name="twitter:description" content="Chapter 7 Graphics | Reporting with Data in R is a series of lessons for a course in the School of Journalism, Moody College of Communication at the University of Texas at Austin. It is taught by Christian McDonald." />
  

<meta name="author" content="Christian McDonald">


<meta name="date" content="2019-02-20">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="cleaning.html">
<link rel="next" href="tidy.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Reporting with Data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this class</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the author</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-resources"><i class="fa fa-check"></i>Other resources</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i><b>1</b> Install Party</a><ul>
<li class="chapter" data-level="1.1" data-path="install.html"><a href="install.html#installing-r"><i class="fa fa-check"></i><b>1.1</b> Installing R</a></li>
<li class="chapter" data-level="1.2" data-path="install.html"><a href="install.html#installing-rstudio"><i class="fa fa-check"></i><b>1.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="install.html"><a href="install.html#install-visual-studio-code"><i class="fa fa-check"></i><b>1.3</b> Install Visual Studio Code</a></li>
<li class="chapter" data-level="1.4" data-path="install.html"><a href="install.html#class-project-folder"><i class="fa fa-check"></i><b>1.4</b> Class project folder</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#rstudio-tour"><i class="fa fa-check"></i><b>2.1</b> RStudio tour</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#updating-preferences"><i class="fa fa-check"></i><b>2.2</b> Updating preferences</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#starting-a-new-project"><i class="fa fa-check"></i><b>2.3</b> Starting a new Project</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#using-r-notebooks"><i class="fa fa-check"></i><b>2.4</b> Using R Notebooks</a><ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#create-your-first-notebook"><i class="fa fa-check"></i><b>2.4.1</b> Create your first notebook</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro.html"><a href="intro.html#save-the-.rmd-file"><i class="fa fa-check"></i><b>2.4.2</b> Save the .Rmd file</a></li>
<li class="chapter" data-level="2.4.3" data-path="intro.html"><a href="intro.html#run-the-notebook"><i class="fa fa-check"></i><b>2.4.3</b> Run the notebook</a></li>
<li class="chapter" data-level="2.4.4" data-path="intro.html"><a href="intro.html#adding-new-code-chunks"><i class="fa fa-check"></i><b>2.4.4</b> Adding new code chunks</a></li>
<li class="chapter" data-level="2.4.5" data-path="intro.html"><a href="intro.html#practice-adding-code-chunks"><i class="fa fa-check"></i><b>2.4.5</b> Practice adding code chunks</a></li>
<li class="chapter" data-level="2.4.6" data-path="intro.html"><a href="intro.html#preview-the-report"><i class="fa fa-check"></i><b>2.4.6</b> Preview the report</a></li>
<li class="chapter" data-level="2.4.7" data-path="intro.html"><a href="intro.html#the-toolbar"><i class="fa fa-check"></i><b>2.4.7</b> The toolbar</a></li>
<li class="chapter" data-level="2.4.8" data-path="intro.html"><a href="intro.html#knit-the-final-workbook"><i class="fa fa-check"></i><b>2.4.8</b> Knit the final workbook</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#turning-in-our-projects"><i class="fa fa-check"></i><b>2.5</b> Turning in our projects</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="import.html"><a href="import.html"><i class="fa fa-check"></i><b>3</b> Importing data</a><ul>
<li class="chapter" data-level="3.1" data-path="import.html"><a href="import.html#goals-for-this-section"><i class="fa fa-check"></i><b>3.1</b> Goals for this section</a></li>
<li class="chapter" data-level="3.2" data-path="import.html"><a href="import.html#data-types"><i class="fa fa-check"></i><b>3.2</b> Data types</a><ul>
<li class="chapter" data-level="3.2.1" data-path="import.html"><a href="import.html#what-is-clean-data"><i class="fa fa-check"></i><b>3.2.1</b> What is clean data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="import.html"><a href="import.html#create-a-new-project"><i class="fa fa-check"></i><b>3.3</b> Create a new project</a><ul>
<li class="chapter" data-level="3.3.1" data-path="import.html"><a href="import.html#the-r-package-environment"><i class="fa fa-check"></i><b>3.3.1</b> The R Package environment</a></li>
<li class="chapter" data-level="3.3.2" data-path="import.html"><a href="import.html#installing-and-using-packages"><i class="fa fa-check"></i><b>3.3.2</b> Installing and using packages</a></li>
<li class="chapter" data-level="3.3.3" data-path="import.html"><a href="import.html#load-the-libraries"><i class="fa fa-check"></i><b>3.3.3</b> Load the libraries</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="import.html"><a href="import.html#lets-get-some-data"><i class="fa fa-check"></i><b>3.4</b> Let’s get some data</a><ul>
<li class="chapter" data-level="3.4.1" data-path="import.html"><a href="import.html#inspect-the-data"><i class="fa fa-check"></i><b>3.4.1</b> Inspect the data</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="import.html"><a href="import.html#import-csv-as-data"><i class="fa fa-check"></i><b>3.5</b> Import csv as data</a><ul>
<li class="chapter" data-level="3.5.1" data-path="import.html"><a href="import.html#help-files"><i class="fa fa-check"></i><b>3.5.1</b> Help files</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="import.html"><a href="import.html#assign-our-data-to-a-data-frame"><i class="fa fa-check"></i><b>3.6</b> Assign our data to a data frame</a></li>
<li class="chapter" data-level="3.7" data-path="import.html"><a href="import.html#inspect-the-data-1"><i class="fa fa-check"></i><b>3.7</b> Inspect the data</a><ul>
<li class="chapter" data-level="3.7.1" data-path="import.html"><a href="import.html#write-notes-about-things-to-change"><i class="fa fa-check"></i><b>3.7.1</b> Write notes about things to change</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="import.html"><a href="import.html#turn-in-your-project"><i class="fa fa-check"></i><b>3.8</b> Turn in your project</a></li>
<li class="chapter" data-level="3.9" data-path="import.html"><a href="import.html#resources"><i class="fa fa-check"></i><b>3.9</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="columns.html"><a href="columns.html"><i class="fa fa-check"></i><b>4</b> Columns</a><ul>
<li class="chapter" data-level="4.1" data-path="columns.html"><a href="columns.html#goals-for-this-section-1"><i class="fa fa-check"></i><b>4.1</b> Goals for this section</a></li>
<li class="chapter" data-level="4.2" data-path="columns.html"><a href="columns.html#relaunch-the-wells-project"><i class="fa fa-check"></i><b>4.2</b> Relaunch the Wells project</a></li>
<li class="chapter" data-level="4.3" data-path="columns.html"><a href="columns.html#clean-up-column-names"><i class="fa fa-check"></i><b>4.3</b> Clean up column names</a><ul>
<li class="chapter" data-level="4.3.1" data-path="columns.html"><a href="columns.html#clean-names-with-janitor"><i class="fa fa-check"></i><b>4.3.1</b> Clean names with janitor</a></li>
<li class="chapter" data-level="4.3.2" data-path="columns.html"><a href="columns.html#simple-renaming-of-individual-columns"><i class="fa fa-check"></i><b>4.3.2</b> Simple renaming of individual columns</a></li>
<li class="chapter" data-level="4.3.3" data-path="columns.html"><a href="columns.html#mass-renaming-of-columns"><i class="fa fa-check"></i><b>4.3.3</b> Mass renaming of columns</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="columns.html"><a href="columns.html#clean-data-within-columns"><i class="fa fa-check"></i><b>4.4</b> Clean data within columns</a><ul>
<li class="chapter" data-level="4.4.1" data-path="columns.html"><a href="columns.html#using-lubridate-to-clean-dates"><i class="fa fa-check"></i><b>4.4.1</b> Using lubridate to clean dates</a></li>
<li class="chapter" data-level="4.4.2" data-path="columns.html"><a href="columns.html#fix-the-bore-hole-depth"><i class="fa fa-check"></i><b>4.4.2</b> Fix the bore hole depth</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="columns.html"><a href="columns.html#export-the-data"><i class="fa fa-check"></i><b>4.5</b> Export the data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="transform.html"><a href="transform.html"><i class="fa fa-check"></i><b>5</b> Transform</a><ul>
<li class="chapter" data-level="5.1" data-path="transform.html"><a href="transform.html#goals-for-the-section"><i class="fa fa-check"></i><b>5.1</b> Goals for the section</a></li>
<li class="chapter" data-level="5.2" data-path="transform.html"><a href="transform.html#introducing-dplyr"><i class="fa fa-check"></i><b>5.2</b> Introducing dplyr</a></li>
<li class="chapter" data-level="5.3" data-path="transform.html"><a href="transform.html#start-a-new-r-notebook"><i class="fa fa-check"></i><b>5.3</b> Start a new R Notebook</a></li>
<li class="chapter" data-level="5.4" data-path="transform.html"><a href="transform.html#record-our-goals"><i class="fa fa-check"></i><b>5.4</b> Record our goals</a></li>
<li class="chapter" data-level="5.5" data-path="transform.html"><a href="transform.html#set-up-our-notebook"><i class="fa fa-check"></i><b>5.5</b> Set up our notebook</a></li>
<li class="chapter" data-level="5.6" data-path="transform.html"><a href="transform.html#import-our-data"><i class="fa fa-check"></i><b>5.6</b> Import our data</a></li>
<li class="chapter" data-level="5.7" data-path="transform.html"><a href="transform.html#filter"><i class="fa fa-check"></i><b>5.7</b> Filter()</a><ul>
<li class="chapter" data-level="5.7.1" data-path="transform.html"><a href="transform.html#filter-your-turn"><i class="fa fa-check"></i><b>5.7.1</b> Filter your turn</a></li>
<li class="chapter" data-level="5.7.2" data-path="transform.html"><a href="transform.html#common-mistakes-with-filter"><i class="fa fa-check"></i><b>5.7.2</b> Common mistakes with filter</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="transform.html"><a href="transform.html#combining-filters"><i class="fa fa-check"></i><b>5.8</b> Combining filters</a><ul>
<li class="chapter" data-level="5.8.1" data-path="transform.html"><a href="transform.html#your-turn-combining-filters"><i class="fa fa-check"></i><b>5.8.1</b> Your turn combining filters</a></li>
<li class="chapter" data-level="5.8.2" data-path="transform.html"><a href="transform.html#common-mistakes-with-combining-filters"><i class="fa fa-check"></i><b>5.8.2</b> Common mistakes with combining filters</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="transform.html"><a href="transform.html#arrange"><i class="fa fa-check"></i><b>5.9</b> Arrange()</a></li>
<li class="chapter" data-level="5.10" data-path="transform.html"><a href="transform.html#multi-step-operations"><i class="fa fa-check"></i><b>5.10</b> Multi-step operations</a><ul>
<li class="chapter" data-level="5.10.1" data-path="transform.html"><a href="transform.html#your-turn-to-combine-and-pipe"><i class="fa fa-check"></i><b>5.10.1</b> Your turn to combine and pipe</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="transform.html"><a href="transform.html#select"><i class="fa fa-check"></i><b>5.11</b> Select()</a></li>
<li class="chapter" data-level="5.12" data-path="transform.html"><a href="transform.html#mutate"><i class="fa fa-check"></i><b>5.12</b> Mutate()</a><ul>
<li class="chapter" data-level="5.12.1" data-path="transform.html"><a href="transform.html#your-turn-to-mutate"><i class="fa fa-check"></i><b>5.12.1</b> Your turn to mutate</a></li>
</ul></li>
<li class="chapter" data-level="5.13" data-path="transform.html"><a href="transform.html#summarize"><i class="fa fa-check"></i><b>5.13</b> Summarize()</a><ul>
<li class="chapter" data-level="5.13.1" data-path="transform.html"><a href="transform.html#ignoring-na"><i class="fa fa-check"></i><b>5.13.1</b> ignoring na</a></li>
<li class="chapter" data-level="5.13.2" data-path="transform.html"><a href="transform.html#your-turn-with-summarise"><i class="fa fa-check"></i><b>5.13.2</b> Your turn with summarise</a></li>
</ul></li>
<li class="chapter" data-level="5.14" data-path="transform.html"><a href="transform.html#group_by"><i class="fa fa-check"></i><b>5.14</b> Group_by()</a><ul>
<li class="chapter" data-level="5.14.1" data-path="transform.html"><a href="transform.html#group-and-count"><i class="fa fa-check"></i><b>5.14.1</b> Group and count</a></li>
<li class="chapter" data-level="5.14.2" data-path="transform.html"><a href="transform.html#your-turn-to-group"><i class="fa fa-check"></i><b>5.14.2</b> Your turn to group</a></li>
<li class="chapter" data-level="5.14.3" data-path="transform.html"><a href="transform.html#counting-only"><i class="fa fa-check"></i><b>5.14.3</b> Counting only</a></li>
</ul></li>
<li class="chapter" data-level="5.15" data-path="transform.html"><a href="transform.html#transform-review"><i class="fa fa-check"></i><b>5.15</b> Transform review</a></li>
<li class="chapter" data-level="5.16" data-path="transform.html"><a href="transform.html#turn-in-your-project-1"><i class="fa fa-check"></i><b>5.16</b> Turn in your project</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="cleaning.html"><a href="cleaning.html"><i class="fa fa-check"></i><b>6</b> Cleaning</a><ul>
<li class="chapter" data-level="6.1" data-path="cleaning.html"><a href="cleaning.html#goals-for-this-section-2"><i class="fa fa-check"></i><b>6.1</b> Goals for this section</a><ul>
<li class="chapter" data-level="6.1.1" data-path="cleaning.html"><a href="cleaning.html#resources-1"><i class="fa fa-check"></i><b>6.1.1</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="cleaning.html"><a href="cleaning.html#taking-stock-of-the-data"><i class="fa fa-check"></i><b>6.2</b> Taking stock of the data</a></li>
<li class="chapter" data-level="6.3" data-path="cleaning.html"><a href="cleaning.html#setup-and-import"><i class="fa fa-check"></i><b>6.3</b> Setup and import</a></li>
<li class="chapter" data-level="6.4" data-path="cleaning.html"><a href="cleaning.html#clean-the-proposed_use-column"><i class="fa fa-check"></i><b>6.4</b> Clean the proposed_use column</a><ul>
<li class="chapter" data-level="6.4.1" data-path="cleaning.html"><a href="cleaning.html#count-values-in-a-column"><i class="fa fa-check"></i><b>6.4.1</b> Count values in a column</a></li>
<li class="chapter" data-level="6.4.2" data-path="cleaning.html"><a href="cleaning.html#change-values-in-a-column"><i class="fa fa-check"></i><b>6.4.2</b> Change values in a column</a></li>
<li class="chapter" data-level="6.4.3" data-path="cleaning.html"><a href="cleaning.html#reassign-your-changes-back-to-the-data-frame"><i class="fa fa-check"></i><b>6.4.3</b> Reassign your changes back to the data frame</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="cleaning.html"><a href="cleaning.html#export-your-updated-data-frame"><i class="fa fa-check"></i><b>6.5</b> Export your updated data frame</a></li>
<li class="chapter" data-level="6.6" data-path="cleaning.html"><a href="cleaning.html#future-addition"><i class="fa fa-check"></i><b>6.6</b> Future addition</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>7</b> Graphics</a><ul>
<li class="chapter" data-level="7.1" data-path="graphics.html"><a href="graphics.html#goals-for-this-section-3"><i class="fa fa-check"></i><b>7.1</b> Goals for this section</a><ul>
<li class="chapter" data-level="7.1.1" data-path="graphics.html"><a href="graphics.html#resources-and-further-reading"><i class="fa fa-check"></i><b>7.1.1</b> Resources and further reading</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="graphics.html"><a href="graphics.html#introduction-ggplot"><i class="fa fa-check"></i><b>7.2</b> Introduction ggplot</a></li>
<li class="chapter" data-level="7.3" data-path="graphics.html"><a href="graphics.html#set-up-our-notebook-1"><i class="fa fa-check"></i><b>7.3</b> Set up our Notebook</a></li>
<li class="chapter" data-level="7.4" data-path="graphics.html"><a href="graphics.html#wells-per-county"><i class="fa fa-check"></i><b>7.4</b> Wells per county</a><ul>
<li class="chapter" data-level="7.4.1" data-path="graphics.html"><a href="graphics.html#shape-our-data"><i class="fa fa-check"></i><b>7.4.1</b> Shape our data</a></li>
<li class="chapter" data-level="7.4.2" data-path="graphics.html"><a href="graphics.html#the-basic-ggplot-template"><i class="fa fa-check"></i><b>7.4.2</b> The basic ggplot template</a></li>
<li class="chapter" data-level="7.4.3" data-path="graphics.html"><a href="graphics.html#plot-our-wells-by-county"><i class="fa fa-check"></i><b>7.4.3</b> Plot our wells by county</a></li>
<li class="chapter" data-level="7.4.4" data-path="graphics.html"><a href="graphics.html#add-a-layer-of-text-labels"><i class="fa fa-check"></i><b>7.4.4</b> Add a layer of text labels</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="graphics.html"><a href="graphics.html#wells-per-county-over-time"><i class="fa fa-check"></i><b>7.5</b> Wells per county over time</a><ul>
<li class="chapter" data-level="7.5.1" data-path="graphics.html"><a href="graphics.html#work-up-the-data-frame"><i class="fa fa-check"></i><b>7.5.1</b> Work up the data frame</a></li>
<li class="chapter" data-level="7.5.2" data-path="graphics.html"><a href="graphics.html#draw-the-plot"><i class="fa fa-check"></i><b>7.5.2</b> Draw the plot</a></li>
<li class="chapter" data-level="7.5.3" data-path="graphics.html"><a href="graphics.html#your-turn-add-layers"><i class="fa fa-check"></i><b>7.5.3</b> Your turn: Add layers</a></li>
<li class="chapter" data-level="7.5.4" data-path="graphics.html"><a href="graphics.html#dates-as-numbers-and-the-problems-they-cause"><i class="fa fa-check"></i><b>7.5.4</b> Dates as numbers and the problems they cause</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="graphics.html"><a href="graphics.html#your-turn-build-a-line-chart"><i class="fa fa-check"></i><b>7.6</b> Your turn: Build a line chart</a></li>
<li class="chapter" data-level="7.7" data-path="graphics.html"><a href="graphics.html#review-of-ggplot"><i class="fa fa-check"></i><b>7.7</b> Review of ggplot</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tidy.html"><a href="tidy.html"><i class="fa fa-check"></i><b>8</b> Tidy data</a></li>
<li class="chapter" data-level="9" data-path="graphics2.html"><a href="graphics2.html"><i class="fa fa-check"></i><b>9</b> Graphics II</a></li>
<li class="chapter" data-level="10" data-path="census.html"><a href="census.html"><i class="fa fa-check"></i><b>10</b> Census</a><ul>
<li class="chapter" data-level="10.1" data-path="census.html"><a href="census.html#resources-2"><i class="fa fa-check"></i><b>10.1</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="joins.html"><a href="joins.html"><i class="fa fa-check"></i><b>11</b> Joins and merges</a></li>
<li class="chapter" data-level="12" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>12</b> Data packages</a></li>
<li class="chapter" data-level="13" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>13</b> Maps</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Reporting with Data in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graphics" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Graphics</h1>
<div id="goals-for-this-section-3" class="section level2">
<h2><span class="header-section-number">7.1</span> Goals for this section</h2>
<ul>
<li>An introduction to the Grammer of Graphics</li>
<li>We’ll make charts!</li>
</ul>
<div id="resources-and-further-reading" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Resources and further reading</h3>
<ul>
<li><a href="http://www.cookbook-r.com/Graphs/">R Graphics Cookbook</a></li>
<li><a href="http://ggplot2.tidyverse.org/reference/index.html">The ggplot2 documentation</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf">ggplot2 cheatsheets</a></li>
<li>Note <a href="https://medium.com/bbc-visual-and-data-journalism/how-the-bbc-visual-and-data-journalism-team-works-with-graphics-in-r-ed0b35693535">This article about BBC using R, ggplot</a>. BBC created the <a href="https://github.com/bbc/bbplot">bblot</a> package to set BBC default styles, and <a href="https://bbc.github.io/rcookbook/">BBC R cookook</a> as a collection of tips and tricks to build their styled graphics.</li>
</ul>
</div>
</div>
<div id="introduction-ggplot" class="section level2">
<h2><span class="header-section-number">7.2</span> Introduction ggplot</h2>
<p><a href="https://ggplot2.tidyverse.org/">ggplot2</a> is the data visualization library within Hadley Wickham’s <a href="https://www.tidyverse.org/">tidyverse.</a>. It uses a concept called the Grammar of graphics, the idea that you can build every graph from the same components: a data set, a coordinate system, and geoms – the visual marks that represent data points. With a hat tip to <a href="http://www.mattwaite.com/">Matt Waite</a>, the main concepts are:</p>
<ul>
<li><strong>aesthetics</strong>: which in this case means the data which we are going to plot</li>
<li><strong>geometries</strong>: which means the shape the data is going to take</li>
<li><strong>scales</strong>: which means any transformations we might make on the data</li>
<li><strong>layers</strong>: which means how we might lay multiple geometries over top of each other to reveal new information.</li>
<li><strong>facets</strong>: which means how we might graph many elements of the same dataset in the same space</li>
</ul>
<p>The challenge to understand here is for every graphic, we start with the data, and then describe how to layer plots or pieces on top of that data.</p>
</div>
<div id="set-up-our-notebook-1" class="section level2">
<h2><span class="header-section-number">7.3</span> Set up our Notebook</h2>
<ul>
<li>Create a new RNotebook. Title it “Wells visualizations” and name the file <code>04-charts.Rmd</code>.</li>
<li>Load the following libraries: tidyverse, lubridate.</li>
<li>Import our <code>wells_03.rds</code> data,</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(lubridate)
wells &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;data-out/wells_03.rds&quot;</span>)</code></pre></div>
</div>
<div id="wells-per-county" class="section level2">
<h2><span class="header-section-number">7.4</span> Wells per county</h2>
<p>For our first graphic, we will plot how many wells were drilled in each county.</p>
<div id="shape-our-data" class="section level3">
<h3><span class="header-section-number">7.4.1</span> Shape our data</h3>
<p>If we are plotting wells per county, we need to first build a data frame that counts the number of wells for each county. We can use the same <code>count()</code> function that we used when we cleaned our data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wells_by_county &lt;-<span class="st"> </span>wells <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">count</span>(county) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">wells_count =</span> n)
wells_by_county</code></pre></div>
<p>Let’s break this down:</p>
<ul>
<li>The first line creates the new data frame <code>wells_by_county</code>, starting with our <code>wells</code> data frame.</li>
<li>We apply the <code>count()</code> function on the “county” column. This makes our basic pivot table.</li>
<li>On the third line, we rename the “n” column that was created by <code>count()</code>, so it is more descriptive, calling it <code>wells_count</code>.</li>
<li>So now we have a data frame with two columns: <strong>county</strong> and <strong>wells_count</strong>. We print it on the fourth line so we can inspect it.</li>
</ul>
</div>
<div id="the-basic-ggplot-template" class="section level3">
<h3><span class="header-section-number">7.4.2</span> The basic ggplot template</h3>
<p>The template for a basic plot is this. (The <code>&lt;&gt;</code> signify we are inserting values there.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>) <span class="op">+</span>
<span class="st">  </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="op">&lt;</span>MAPPINGS<span class="op">&gt;</span>))</code></pre></div>
<ul>
<li><strong>ggplot()</strong> is our function. We feed into it the data we wish to plot.</li>
<li>The <strong>+</strong> is the equivalent of <code>%&gt;%</code> in our tidyverse data. It means we are adding a layer, and it should always be at the end of the line, not at the beginning of the next.</li>
<li><strong><GEOM_FUNCTION></strong> is the type of chart or addition we are adding. They all start with the term <strong>geom_</strong> like <strong>geom_bar</strong>, which is what we will build.</li>
<li>The geometric function requires “aesthetics” to describe what it should look like, the main one being the <strong>mapping</strong> of the x and y axis.</li>
</ul>
<p>There are two ways to simplify this:</p>
<ul>
<li>It is implied that the first thing fed to <code>ggplot</code> is the data, so you don’t have to write out <code>data =</code> unless there is ambiguity.</li>
<li>The <code>aes()</code> values are also implied as mappings, so you don’t have to write out <code>mapping =</code> unless there is ambiguity.</li>
<li>And lastly, if the mappings are the same for all the geoms, you can put them in the ggplot line.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="op">&lt;</span>DATA<span class="op">&gt;</span>, <span class="kw">aes</span>(<span class="op">&lt;</span>MAPPINGS<span class="op">&gt;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="er">&lt;</span>GEOM<span class="op">&gt;</span>(<span class="op">&lt;</span>ADDITONAL_MAPPINGS<span class="op">&gt;</span>)</code></pre></div>
</div>
<div id="plot-our-wells-by-county" class="section level3">
<h3><span class="header-section-number">7.4.3</span> Plot our wells by county</h3>
<p>Here is the verbose plot for our counties.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> wells_by_county) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> county, <span class="dt">y =</span> wells_count), <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>)</code></pre></div>
<ul>
<li>On the first line we tell <code>ggplot()</code> that we are using the we <code>wells_by_county</code> data.</li>
<li>On the next, we apply the <code>geom_bar()</code> function to make a bar chart. It needs two things:
<ul>
<li>The mapping, which are the aesthetics. We well it to plot <strong>county</strong> on the x (horizontal) axis, and <strong>wells_count</strong> on the y (vertical) axis. Because <strong>county</strong> is not a number, we have to use the <code>stat = &quot;identity&quot;</code> value to describe that we are using values within county. This is a special thing for bar charts.</li>
</ul></li>
</ul>
<div class="figure">
<img src="images/visualize-county-plot.png" alt="Basic county plot" width="500" />
<p class="caption">Basic county plot</p>
</div>
<p>Our less verbose way to do this looks like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(wells_by_county, <span class="kw">aes</span>(<span class="dt">x=</span>county, <span class="dt">y=</span>wells_count)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>)</code></pre></div>
</div>
<div id="add-a-layer-of-text-labels" class="section level3">
<h3><span class="header-section-number">7.4.4</span> Add a layer of text labels</h3>
<p>For each new thing that we add to our graphic, we add it with <code>+</code>. In this case, we want to add number labels to show the wells_count for that county.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> wells_by_county, <span class="kw">aes</span>(<span class="dt">x =</span> county, <span class="dt">y =</span> wells_count)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>wells_count), <span class="dt">vjust=</span><span class="op">-</span><span class="fl">0.25</span>)</code></pre></div>
<div class="figure">
<img src="images/visualize-county-plot-labels.png" alt="Basic county plot" width="500" />
<p class="caption">Basic county plot</p>
</div>
<p>In this case, we are just adding another layer, the <code>geom_text()</code>. It requires some additional aesthetics, like what label we want to use. The <code>vjust=</code> moves the numbers up a little. Change the number and see what happens.</p>
<p>The last layer we want to add here is a Title layer. The function for labels is called <code>labs()</code> and it takes an argument of <code>title = &quot;&quot;</code> You can also change your <code>x</code> and <code>y</code> axis names, etc.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  ... <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Number of wells drilled by county&quot;</span>)</code></pre></div>
<p>Congratulations! You made your first <code>ggplot()</code> chart. Not particularly revealing, but it does show that Travis County has WAY more wells than the other counties.</p>
<p>Let’s see how those trends play out over time.</p>
</div>
</div>
<div id="wells-per-county-over-time" class="section level2">
<h2><span class="header-section-number">7.5</span> Wells per county over time</h2>
<p>Our next chart will be a line chart to show how the number of wells drilled has changed over time within each county.</p>
<p>Again, it will help us to think about what we are after and then build our data frame to match. In this case, we want to plot the “number of wells” for each county, by year. That means we need columns for county, year and number of wells. To get that, we have to use group and summarize.</p>
<p>Sometimes it helps to write out the steps of everything before you to do it.</p>
<ul>
<li>Start with the <code>wells</code> data frame.</li>
<li>Filter to 2003 or later, because that’s when the <a href="http://www.twdb.texas.gov/groundwater/data/drillersdb.asp">system came online</a>.</li>
<li>Group by the <code>county</code> and <code>year_drilled</code> fields.</li>
<li>Summarize to create a count the number of <code>wells_drilled</code>.</li>
<li>Set all of the above to a new data frame, <code>wells_county_year</code>.</li>
<li>Start a plot with the new data.</li>
<li>Set x (horizontal) to be year_drilled and y (vertical) to be wells_drilled, and color to be the county.</li>
</ul>
<div id="work-up-the-data-frame" class="section level3">
<h3><span class="header-section-number">7.5.1</span> Work up the data frame</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wells <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(year_drilled <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2003</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(county, year_drilled) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(
    <span class="dt">wells_drilled =</span> <span class="kw">n</span>()
  )</code></pre></div>
<p>This gives you a table similar to this:</p>
<table>
<thead>
<tr class="header">
<th align="left">county</th>
<th align="left">year_drilled</th>
<th align="right">wells_drilled</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Bastrop</td>
<td align="left">2003</td>
<td align="right">110</td>
</tr>
<tr class="even">
<td align="left">Bastrop</td>
<td align="left">2004</td>
<td align="right">99</td>
</tr>
<tr class="odd">
<td align="left">Bastrop</td>
<td align="left">2005</td>
<td align="right">97</td>
</tr>
<tr class="even">
<td align="left">…</td>
<td align="left">…</td>
<td align="right">…</td>
</tr>
<tr class="odd">
<td align="left">Caldwell</td>
<td align="left">2003</td>
<td align="right">40</td>
</tr>
<tr class="even">
<td align="left">Caldwell</td>
<td align="left">2004</td>
<td align="right">32</td>
</tr>
<tr class="odd">
<td align="left">Caldwell</td>
<td align="left">2005</td>
<td align="right">40</td>
</tr>
</tbody>
</table>
<p>We call this <em>long</em> data, because each row contains a single observation, instead of <em>wide</em> data, which would have a column for each observation.</p>
<p>Once you are have the data formatted, set it to fill a new data frame called <code>wells_county_year</code>.</p>
</div>
<div id="draw-the-plot" class="section level3">
<h3><span class="header-section-number">7.5.2</span> Draw the plot</h3>
<p>Remember the formula for a basic plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="op">&lt;</span>DATA<span class="op">&gt;</span>) <span class="op">+</span>
<span class="st">  </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>(<span class="kw">aes</span>(<span class="op">&lt;</span>MAPPINGS<span class="op">&gt;</span>))</code></pre></div>
<p>and if all our mappings are the same, they can go into the ggplot function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(wells_county_year, <span class="kw">aes</span>(<span class="dt">x =</span> year_drilled, <span class="dt">y =</span> wells_drilled, <span class="dt">color =</span> county)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()</code></pre></div>
<div class="figure">
<img src="images/visualize-county-year-line.png" alt="Wells drilled by county by year" width="500" />
<p class="caption">Wells drilled by county by year</p>
</div>
<p>How easy would it be to add points for every year to make each data point stand out?</p>
</div>
<div id="your-turn-add-layers" class="section level3">
<h3><span class="header-section-number">7.5.3</span> Your turn: Add layers</h3>
<ul>
<li>Add a new layer <code>geom_point()</code> and see what happens</li>
<li>Add a labels layer to add a title, like we did in the bar chart above.</li>
</ul>
</div>
<div id="dates-as-numbers-and-the-problems-they-cause" class="section level3">
<h3><span class="header-section-number">7.5.4</span> Dates as numbers and the problems they cause</h3>
<p>There was one point during my work on this graphic when my x axis did not fall evenly on years, and I figured it was because the <code>year_drilled</code> field was a number and not a date. It’s possible to fix that by including the <code>library(lubridate)</code> and then mutating the year_drilled column like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">mutate</span>(
    <span class="dt">year_drilled =</span> <span class="kw">ymd</span>(year_drilled, <span class="dt">truncated=</span>2L)
  ) <span class="op">%&gt;%</span></code></pre></div>
</div>
</div>
<div id="your-turn-build-a-line-chart" class="section level2">
<h2><span class="header-section-number">7.6</span> Your turn: Build a line chart</h2>
<p>Now, I’d like you to build a line chart that shows how the different kinds of wells drilled has changed over time. Here’s a major hint: It’s very much like the line chart you just built, but with different columns. You’ll need so start at creating a data frame with the correct data.</p>
</div>
<div id="review-of-ggplot" class="section level2">
<h2><span class="header-section-number">7.7</span> Review of ggplot</h2>
<p>Exploring with graphics are one of the more powerful features of working with R. It takes a bit to get used to the Grammar of Graphics and ggplot2 and it will be frustrating at first. But be assured it can do about anything once you learn how, and being able to fold in these charts with your thoughts and analysis in a repeatable way will make you a better data journalist.</p>
<p>By design, every chart in ggplot starts with the same three things: data, a geometric coordinate system, and a mapping of the aesthetics, including the x and y values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>) <span class="op">+</span>
<span class="st">  </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="op">&lt;</span>MAPPINGS<span class="op">&gt;</span>))</code></pre></div>
<p>If your graphic is simple, there may be less verbose ways to write it as ggplot will assume your are passing it data first, and that <code>aes()</code> functions are for mapping.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cleaning.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tidy.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/07-graphics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
